(()=>{"use strict";var e={711:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(519),t)},519:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(795);function o(e,t){figma.on(e,((...e)=>{try{t(...e)}catch(e){console.error(e)}}))}o("selectionchange",(()=>(0,n.updateSections)())),o("currentpagechange",(()=>(0,n.updateSections)())),o("documentchange",(e=>{for(const t of e.documentChanges)switch(t.type){case"DELETE":console.log(`Node ${t.id} deleted by a ${t.origin.toLowerCase()} user`),(0,n.updateSections)();break;case"PROPERTY_CHANGE":(t.properties||[]).includes("characters")&&(0,n.updateNodeOriginText)(t.node)}})),o("close",(()=>{})),figma.ui.onmessage=e=>{try{console.log("got MSG from PLUGIN UI",e);const{event:t,data:r}=e,{id:o,text:c}=r;switch(t){case"SYNC_TEXT":(0,n.asyncText)(o,c);break;case"HIGHLIGHT_TEXT":(0,n.selectTextRange)(r.id);break;case"PLUGIN_MOUNTED":(0,n.updateSections)();break;case"GET_KEY":(0,n.getKey)(r.key,((e,t)=>{(0,n.postMessage)("GET_KEY",t)}));break;case"SET_KEY":(0,n.setKey)(r.key,r.value)}}catch(e){console.error(e)}},figma.showUI(__html__,{visible:!0,width:350,height:700})},795:(e,t)=>{function r(){const e=[];return function e(t,r=[]){t.forEach((t=>{t.visible&&("TEXT"===t.type?r.push({id:t.id,characters:t.characters}):t.text&&("TextSublayerNode"===t.text.constructor.name||t.text.characters)&&r.push({id:t.id,characters:t.text.characters}),t.children&&e(t.children,r))}))}(figma.currentPage.selection,e),e}function n(e,t){figma.ui.postMessage({event:e,data:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.postMessage=t.updateNodeOriginText=t.updateSections=t.ignoreSelectionHelper=t.getSelectedTextNodes=t.setKey=t.getKey=t.asyncText=t.zoomIntoView=t.selectTextRange=void 0,t.selectTextRange=function(e){if(!e)return!1;const r=figma.currentPage.findOne((t=>t.id===e));if(!r)return!1;t.ignoreSelectionHelper.setCurrentNode(r);const n=r.text?r.text:r;return figma.currentPage.selectedTextRange={node:n,start:0,end:n.characters.length},!0},t.zoomIntoView=function(e){if(!e)return!1;const t=figma.currentPage.findOne((t=>t.id===e));if(!t)return!1;const r=figma.viewport.zoom;return figma.viewport.scrollAndZoomIntoView([t]),figma.viewport.zoom=r,!0},t.asyncText=async function(e,r){if(!e)return!1;const n=figma.currentPage.findOne((t=>t.id===e));if(!n)return!1;const o=n.text?n.text:n;try{await Promise.allSettled(o.getRangeAllFontNames(0,o.characters.length).map(figma.loadFontAsync))}catch(e){console.error(e)}try{await figma.loadFontAsync(o.fontName)}catch(e){console.error(e)}return o.characters=r,t.ignoreSelectionHelper.setCurrentNode({id:e}),!0},t.getKey=function(e,t){figma.clientStorage.getAsync(e).then(((r="NO_DATA")=>{t(null,{key:e,value:r})})).catch((e=>console.error(e)))},t.setKey=function(e,t){figma.clientStorage.setAsync(e,t).catch((e=>console.error(e)))},t.getSelectedTextNodes=r,t.ignoreSelectionHelper=function(){let e,r;return{setCurrentNode:n=>{r&&clearTimeout(r),e=n,r=setTimeout((()=>t.ignoreSelectionHelper.setCurrentNode(null)),300)},currentNode:()=>e}}(),t.updateSections=function(){var e,o;const c=r();c&&1===c.length&&t.ignoreSelectionHelper.currentNode()&&(null===(e=c[0])||void 0===e?void 0:e.id)===(null===(o=t.ignoreSelectionHelper.currentNode())||void 0===o?void 0:o.id)?t.ignoreSelectionHelper.setCurrentNode(null):n("UPDATE_SELECTIONS",c)},t.updateNodeOriginText=function(e){n("UPDATE_ORIGIN_TEXT",{id:e.id,characters:e.characters})},t.postMessage=n}},t={};!function r(n){var o=t[n];if(void 0!==o)return o.exports;var c=t[n]={exports:{}};return e[n].call(c.exports,c,c.exports,r),c.exports}(711)})();